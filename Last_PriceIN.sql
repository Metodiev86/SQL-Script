WITH RankedOperations AS (
    SELECT 
        Goods.Code, 
        Goods.Name, 
        Operations.PriceIn, 
        Operations.Date,
        ROW_NUMBER() OVER (PARTITION BY Goods.Code ORDER BY Operations.Date DESC) AS rn
    FROM Goods
    LEFT JOIN Operations ON Goods.ID = Operations.GoodID
    WHERE Goods.Code IN ('15010012', '15010016', '15010023', '15010031', '15010034', '15010056', '15010057', '15010058', '15010065', '15010066', '15010070', '20010002', '20010003', '20010012', '20010013', '20010016', '20010024', '20010028', '20010029', '20010030', '20010032', '20010033', '20010034', '20010037', '20010038', '20010041', '20010042', '20010045', '20010046', '20010050', '20010051', '20010052', '20010053', '20010054', '20010057', '20010060', '20010061', '20010077', '20010078', '20010080', '20010104', '20010105', '20010107', '20010108', '20010109', '20010110', '20010117', '20010130', '20010131', '20010132', '34010065', '34080020', '34080021', '41010352', '41010392', '41010559', '41010583', '41011102', '41011491', '47100023', '54030034', '54090002', '54090004', '54110001', '66010056', '66010058', '67010012', '68010006', '88020123', '114010008', '114010010', '114010014', '115020001', '117010035', '118010008', '119020003', '125060011', '132020012', '147020081', '1173040007', '60155010092', '60159030027', '60159030028', '60165020095', '60165020105', '60165020178', '60165020181', '60165020185', '60165020196', '60165040014', '60187020016', '60187020070') AND Operations.PriceIn !=0
)
SELECT *
FROM RankedOperations
WHERE rn = 1;