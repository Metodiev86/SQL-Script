/* Payment */
SELECT DISTINCT pay.ID AS 'ID на Плащане', pay.Acct AS 'Стокова', pay.Date AS 'Дата на Стоковата', 
	pay.EndDate AS 'Дата на Падеж',  pay.mode AS 'Платил/Неплатил', pay.qtty AS 'Обща Стойност',
 
					/* Document */
	doc.ExternalInvoiceNumber AS 'Фактура 2', doc.InvoiceDate AS 'Дата на Фактура/Кредитно',  doc.OperType AS 'Операция при Фактура',
	doc.invoiceNumber AS 'Документ No', operType.BG AS 'Вид на Операцията', oper.OperType AS 'Операция при Стокова',

					/* Partner */
	par.ID AS Партньор_ID, par.Company AS Партньор, pargr.Name AS 'Партньор Група', par.City AS 'Град', par.eMail AS 'Email'

				/* END SELECT */

FROM Payments as pay

	LEFT JOIN Documents AS doc ON pay.Acct = doc.Acct and doc.OperType = pay.OperType
	LEFT JOIN Partners AS par ON Pay.PartnerID = par.ID
	LEFT JOIN Operations AS oper ON pay.Acct = oper.Acct
	LEFT JOIN PartnersGroups AS parGR ON par.GroupID = parGR.ID
	LEFT JOIN OperationType AS operType ON pay.OperType = operType.ID


WHERE (par.ID NOT IN (24100, 8002455, 8003130, 8003650, 8004027, 8005058, 8005587, 8005607, 8005770, 8005942, 8006416, 8006429, 8006553
)  OR pay.ID NOT IN (6000679, 6000685, 6000680, 448940, 517987, 461184, 
461141, 460454, 458879, 457286, 456566, 448384, 447487, 447471, 447329, 442345,
441751, 441597, 458570, 458013, 457230, 448901, 448878, 448819, 448443, 447210, 
447062, 437624, 489402, 458302, 448052, 447945, 446766, 441344, 438393, 438240, 
437832, 437827, 473953, 473466, 469138, 468421, 468538, 469442, 482115, 482482,
482615, 483514, 486151, 486406, 486597, 486786, 487302, 463750, 470826, 474838,
474854, 475224, 475609, 475685, 476115, 477248, 477389, 477717, 478167, 478171,
478385, 478386, 478444, 516290, 520010, 377196, 378509, 380201, 381706, 381999, 
453988, 454100, 455263, 455606, 462396, 462456, 462849, 463108, 463291, 464198, 
466025, 466227, 466590, 466885, 467430, 469795, 470169, 471209, 472261, 472265,
472936, 478405, 481567, 484154, 486775, 488337, 488803, 491278, 492556, 493446,
517815, 493767, 507591, 464364, 464652, 467046, 467234, 467456, 470069, 471793,
472372, 472408, 472581, 479735, 479987, 479988, 480008, 480130, 480479, 480812, 
480840, 480933, 481192, 481458, 481706, 481900, 487684, 488773, 488775, 488786, 
488863, 489355, 490080, 490118, 491089, 491540, 491694, 492308, 492770, 492771, 
492941, 493015, 377083, 376855, 377161, 378748, 378820, 379335, 379727, 380923, 
381051, 382292, 383444, 383521, 383678, 384874, 384888, 384922, 384930, 389408, 
385765, 385842, 435747, 449329, 449464, 450508, 451124, 451128, 451721, 452174, 
452378, 453197, 453276, 454364, 454807, 455446, 461639, 451717, 451860, 452193, 
452195, 452198, 452632, 452669, 453115, 453727, 453729, 453730, 454433, 456142, 
511895, 507567, 507566, 380476, 449594, 449742, 6000693, 66, 99, 8001312, 376699, 
6000681, 6000678, 526673, 6000689, 6000682, 375362, 528636))
AND 
	operType.BG IN ('Дебитно известие', 'Кредитно известие', 'Отчитане на консигнация', 'Продажба') 
AND 
	oper.OperType IN (2, 16, 26, 27)